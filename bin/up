#!/bin/bash
# Run git pull or an equivalent for whatever SCM is used in current directory.

export STOP_FILES=

ROOT="$(scm-root)"
if [[ -z "$ROOT" ]]; then
  return 1
fi

if [[ -r "$ROOT/.git/config" ]] && grep svn-remote "$ROOT/.git/config" >/dev/null 2>&1; then
  cmd='git svn rebase --fetch-all'
elif [[ -d "$ROOT/.git5_specs" ]] && [[ -d "$ROOT/.git" ]]; then
  cmd='git5 sync'
elif [[ -d "$ROOT/.git" ]]; then
  cmd='git pull'
elif [[ -d "$ROOT/.svn" ]]; then
  cmd="cd \"$ROOT\"; svn update"
else
  echo 'Not in a repository'
  return 1
fi

bash -c -x "$cmd"
exit $?
